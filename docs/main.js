(()=>{"use strict";const e={resourceFiles:"Resource files",layoutFiles:"Layout files",errors:"Errors",warnings:"Warnings",infos:"Info messages"};function t(t){return e?.[t]||t}async function n(e,t,n){e.preventDefault();const s=e.target;s.innerHTML="",s.classList.remove("drag-over"),t=await async function(e,t,n){const s=e.target.files||e.dataTransfer.files,r=[];for(var i=0;i<s.length;i++){const e=s[i],a=new FileReader,o=new Promise(((s,r)=>{a.onload=i=>{try{n[t][e.name]=JSON.parse(i.target.result),s()}catch(s){n[t][e.name]||(n[t][e.name]={errors:[]}),n[t][e.name].errors||(n[t][e.name].errors=[]),n[t][e.name].errors.push({label:"Error parsing file",message:s}),r(s)}},a.readAsText(e)}));r.push(o)}return await Promise.all(r).then((()=>n)).catch((e=>n))}(e,n,t),s.appendChild(function(e){const t=document.createElement("ul");return t.classList.add("file-list"),Object.keys(e).forEach((n=>{const s=e[n],r=document.createElement("li");r.classList.add("file");const i=document.createElement("span");if(i.textContent=n,r.appendChild(i),s.errors?.length){r.classList.add("has-errors");const e=function(e){const t=document.createElement("ul");return t.classList.add("error-list"),e.forEach((e=>{const n=document.createElement("li");n.classList.add("error");const s=document.createElement("span");s.classList.add("error-label"),s.textContent=`${e.label}: `;const r=document.createElement("span");r.classList.add("error-message"),r.textContent=e.message,n.appendChild(s),n.appendChild(r),t.appendChild(n)})),t}(s.errors);r.appendChild(e)}t.appendChild(r)})),t}(t[n]))}function s(e){e.preventDefault(),e.target.classList.add("drag-over")}function r(e){e.preventDefault(),e.target.classList.remove("drag-over")}const i=["pdfPreviewText","appOwner","appName"];function a(e,t,n,s){const r=function(e,t){if(!t)return e;const n=t?.split(/\.|\[|\]/).filter(Boolean);for(let t=0;t<n.length;t++)e=e[n[t]];return e}(n,s),i=r.startsWith("resource."),a=""===r;if(i){const i=function(e,t){let n={};return Object.keys(t.resourceFiles).forEach((s=>{const r=t.resourceFiles[s];let i=!0;r?.resources?.forEach((t=>{t.id!==e||(i=!1)})),n[s]=i})),n}(r,e);Object.keys(i).forEach((e=>{i[e]&&t.errors.push(`Resource binding "${r}" for key "${s}" in "${n.id}" is missing in file "${e}"`)}))}else a?t.infos.push(`Resource binding for key "${s}" in "${n.id}" is empty`):t.warnings.push(`Resource binding "${r}" for key "${s}" in "${n.id}" is not a valid resource ID or has a fixed value`)}const o={resourceFiles:{},layoutFiles:{}};window.onload=function(){!function(e){const o=document.getElementById("resourceFilesDropzone"),c=document.getElementById("layoutFilesDropzone"),d=document.getElementById("validateButton");o.addEventListener("drop",(t=>{n(t,e,"resourceFiles")})),o.addEventListener("dragover",(e=>{s(e)})),o.addEventListener("dragleave",(e=>{r(e)})),c.addEventListener("drop",(t=>{n(t,e,"layoutFiles")})),c.addEventListener("dragover",(e=>{s(e)})),c.addEventListener("dragleave",(e=>{r(e)})),d.addEventListener("click",(()=>{!function(e){const n=document.getElementById("validationResults");n.innerHTML="";const s=function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("filetypes"),n.forEach((r=>{const i=function(e,n){const s=document.createElement("details");s.classList.add("filetype"),s.open=!0;const r=document.createElement("summary");return r.textContent=`${t(e)} (${Object.keys(n).length})`,r.style.setProperty("--indent",0),s.appendChild(r),s.appendChild(function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("files"),n.forEach((n=>{const r=function(e,n){const s=document.createElement("details");s.classList.add("file"),s.open=!0;let r=!1;Object.keys(n).forEach((e=>{n[e].length&&(r=!0)})),r?s.classList.add("hasValidationMessages"):s.classList.add("noValidationMessages");const i=document.createElement("summary");return i.textContent=e,i.style.setProperty("--indent",1),s.appendChild(i),s.appendChild(function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("validationTypes"),n.forEach((n=>{const r=e[n];if(r.length){const e=function(e,n){const s=document.createElement("details");s.classList.add("validationType"),s.classList.add(e),s.open=!0;const r=document.createElement("summary");return r.textContent=`${t(e)} (${n.length})`,r.style.setProperty("--indent",2),s.appendChild(r),s.appendChild(function(e){const t=e,n=document.createElement("div");return n.classList.add("validationMessages"),t.forEach((e=>{const t=function(e){const t=document.createElement("div");return t.classList.add("validationMessage"),t.textContent=e,t.style.setProperty("--indent",3),t}(e);n.appendChild(t)})),n}(n)),s}(n,r);s.appendChild(e)}})),s}(n)),s}(n,e[n]);s.appendChild(r)})),s}(n)),s}(r,e[r]);if(s.appendChild(i),n.indexOf(r)<n.length-1){const e=document.createElement("hr");s.appendChild(e)}})),s}(e);n.appendChild(s)}(function(e){const t={};return Object.keys(e).forEach((n=>{const s=e[n];t[n]||(t[n]={}),Object.keys(s).forEach((r=>{const o=function(e,t,n){const s={errors:[],warnings:[],infos:[]};if("resourceFiles"===t){let t=!1,r=!1,a=!1,o=!1,c=!1,d=!1;e?.resources?.forEach((e=>{i.includes(e.id)?"pdfPreviewText"===e.id?(t=!0,r=""===e.value):"appOwner"===e.id?(a=!0,o=""===e.value):"appName"===e.id&&(c=!0,d=""===e.value):function(e,t){let n={textResourceBindings:!0,options:!0};return Object.keys(t.layoutFiles).forEach((s=>{const r=t.layoutFiles[s],i=r?.data?.layout;i.forEach((t=>{t?.textResourceBindings&&Object.keys(t.textResourceBindings).forEach((s=>{t.textResourceBindings[s]!==e.id||(n=!1)})),t?.options&&t.options.forEach((t=>{t.label!==e.id||(n=!1)}))}))})),n.textResourceBindings&&n.options}(e,n)&&s.warnings.push(`Resource "${e.id}" is unused`)})),t?r&&s.warnings.push('Resource with id "pdfPreviewText" is empty and will maybe be replaced with a default value'):s.errors.push('Resource with id "pdfPreviewText" is missing and will be replaced with a default value'),a?o&&s.warnings.push('Resource with id "appOwner" is empty'):s.errors.push('Resource with id "appOwner" is missing and is required'),c?d&&s.warnings.push('Resource with id "appName" is empty'):s.errors.push('Resource with id "appName" is missing and is required')}else"layoutFiles"===t&&e?.data?.layout?.forEach((e=>{e?.textResourceBindings&&Object.keys(e.textResourceBindings).forEach((t=>{a(n,s,e,`textResourceBindings.${t}`)})),e?.options&&e.options.forEach(((t,r)=>{t.label&&a(n,s,e,`options[${r}].label`)}))}));return s}(s[r],n,e);t[n][r]=o}))})),t}(e))}))}(o,validationResults)}})();