(()=>{"use strict";const e={resourceFiles:"Resource files",layoutFiles:"Layout files",errors:"Errors",warnings:"Warnings",infos:"Info messages"};function t(t){return e?.[t]||t}async function n(e,t,n){e.preventDefault();const s=e.target;s.innerHTML="",s.classList.remove("drag-over"),t=await async function(e,t,n){const s=e.target.files||e.dataTransfer.files,r=[];for(var a=0;a<s.length;a++){const e=s[a],i=new FileReader,o=new Promise(((s,r)=>{i.onload=a=>{try{n[t][e.name]=JSON.parse(a.target.result),s()}catch(s){n[t][e.name]||(n[t][e.name]={errors:[]}),n[t][e.name].errors||(n[t][e.name].errors=[]),n[t][e.name].errors.push({label:"Error parsing file",message:s}),r(s)}},i.readAsText(e)}));r.push(o)}return await Promise.all(r).then((()=>n)).catch((e=>n))}(e,n,t),s.appendChild(function(e){const t=document.createElement("ul");return t.classList.add("file-list"),Object.keys(e).forEach((n=>{const s=e[n],r=document.createElement("li");r.classList.add("file");const a=document.createElement("span");if(a.textContent=n,r.appendChild(a),s.errors?.length){r.classList.add("has-errors");const e=function(e){const t=document.createElement("ul");return t.classList.add("error-list"),e.forEach((e=>{const n=document.createElement("li");n.classList.add("error");const s=document.createElement("span");s.classList.add("error-label"),s.textContent=`${e.label}: `;const r=document.createElement("span");r.classList.add("error-message"),r.textContent=e.message,n.appendChild(s),n.appendChild(r),t.appendChild(n)})),t}(s.errors);r.appendChild(e)}t.appendChild(r)})),t}(t[n]))}function s(e){e.preventDefault(),e.target.classList.add("drag-over")}function r(e){e.preventDefault(),e.target.classList.remove("drag-over")}const a=["pdfPreviewText","appOwner","appName"];const i={resourceFiles:{},layoutFiles:{}};window.onload=function(){!function(e){const i=document.getElementById("resourceFilesDropzone"),o=document.getElementById("layoutFilesDropzone"),c=document.getElementById("validateButton");i.addEventListener("drop",(t=>{n(t,e,"resourceFiles")})),i.addEventListener("dragover",(e=>{s(e)})),i.addEventListener("dragleave",(e=>{r(e)})),o.addEventListener("drop",(t=>{n(t,e,"layoutFiles")})),o.addEventListener("dragover",(e=>{s(e)})),o.addEventListener("dragleave",(e=>{r(e)})),c.addEventListener("click",(()=>{!function(e){const n=document.getElementById("validationResults");n.innerHTML="";const s=function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("filetypes"),n.forEach((r=>{const a=function(e,n){const s=document.createElement("details");s.classList.add("filetype"),s.open=!0;const r=document.createElement("summary");return r.textContent=`${t(e)} (${Object.keys(n).length})`,r.style.setProperty("--indent",0),s.appendChild(r),s.appendChild(function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("files"),n.forEach((n=>{const r=function(e,n){const s=document.createElement("details");s.classList.add("file"),s.open=!0;const r=document.createElement("summary");return r.textContent=e,r.style.setProperty("--indent",1),s.appendChild(r),s.appendChild(function(e){const n=Object.keys(e),s=document.createElement("div");return s.classList.add("validationTypes"),n.forEach((n=>{const r=e[n];if(r.length){const e=function(e,n){const s=document.createElement("details");s.classList.add("validationType"),s.classList.add(e),s.open=!0;const r=document.createElement("summary");return r.textContent=`${t(e)} (${n.length})`,r.style.setProperty("--indent",2),s.appendChild(r),s.appendChild(function(e){const t=e,n=document.createElement("div");return n.classList.add("validationMessages"),t.forEach((e=>{const t=function(e){const t=document.createElement("div");return t.classList.add("validationMessage"),t.textContent=e,t.style.setProperty("--indent",3),t}(e);n.appendChild(t)})),n}(n)),s}(n,r);s.appendChild(e)}})),s}(n)),s}(n,e[n]);s.appendChild(r)})),s}(n)),s}(r,e[r]);if(s.appendChild(a),n.indexOf(r)<n.length-1){const e=document.createElement("hr");s.appendChild(e)}})),s}(e);n.appendChild(s)}(function(e){const t={};return Object.keys(e).forEach((n=>{const s=e[n];t[n]||(t[n]={}),Object.keys(s).forEach((r=>{const i=function(e,t,n){const s=[],r=[],i=[];if("resourceFiles"===t){let t=!1,i=!1,o=!1,c=!1,d=!1,l=!1;e?.resources?.forEach((e=>{a.includes(e.id)?"pdfPreviewText"===e.id?(t=!0,i=""===e.value):"appOwner"===e.id?(o=!0,c=""===e.value):"appName"===e.id&&(d=!0,l=""===e.value):function(e,t){let n=!0;return Object.keys(t.layoutFiles).forEach((s=>{const r=t.layoutFiles[s],a=r?.data?.layout;a.forEach((t=>{t?.textResourceBindings&&Object.keys(t.textResourceBindings).forEach((s=>{t.textResourceBindings[s]!==e.id||(n=!1)}))}))})),n}(e,n)&&r.push(`Resource "${e.id}" is unused`)})),t?i&&r.push('Resource with id "pdfPreviewText" is empty and will maybe be replaced with a default value'):s.push('Resource with id "pdfPreviewText" is missing and will be replaced with a default value'),o?c&&r.push('Resource with id "appOwner" is empty'):s.push('Resource with id "appOwner" is missing and is required'),d?l&&r.push('Resource with id "appName" is empty'):s.push('Resource with id "appName" is missing and is required')}else"layoutFiles"===t&&e?.data?.layout?.forEach((e=>{e?.textResourceBindings&&Object.keys(e.textResourceBindings).forEach((t=>{const a=e.textResourceBindings[t],o=a.startsWith("resource."),c=""===a;if(o){const t=function(e,t){let n={};return Object.keys(t.resourceFiles).forEach((s=>{const r=t.resourceFiles[s];let a=!0;r?.resources?.forEach((t=>{t.id!==e||(a=!1)})),n[s]=a})),n}(a,n);Object.keys(t).forEach((n=>{t[n]&&s.push(`Resource binding for the key "${a}" in "${e.id}" is missing in file "${n}"`)}))}else c?i.push(`Resource binding for key "${t}" in "${e.id}" is empty`):r.push(`Resource binding for key "${t}" in "${e.id}" is not a valid resource ID or has a fixed value`)}))}));return{errors:s,warnings:r,infos:i}}(s[r],n,e);t[n][r]=i}))})),t}(e))}))}(i,validationResults)}})();